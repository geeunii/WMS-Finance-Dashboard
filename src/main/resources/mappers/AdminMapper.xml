<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssg.wms.admin.mappers.AdminMapper">

    <resultMap id="StaffResultMap" type="com.ssg.wms.admin.domain.Staff">
        <id property="staffId" column="staff_id"/>
        <result property="staffLoginId" column="staff_login_id"/>
        <result property="staffName" column="staff_name"/>
        <result property="staffPw" column="staff_pw"/>
        <result property="staffPhone" column="staff_phone"/>
        <result property="staffEmail" column="staff_email"/>
        <result property="role" column="role"/>
        <result property="status" column="status"/>
        <result property="createdAt" column="created_at"/>
        <result property="updatedAt" column="updated_at"/>
    </resultMap>

    <!-- 직원 정보 조회 -->
    <select id="getStaffDetails" resultType="StaffDTO">
        SELECT staff_login_id, staff_name, staff_phone, staff_email, role, status, created_at, updated_at
        FROM staff
        WHERE staff_id = #{staffId}
    </select>

    <!-- 고객 목록 조회 (검색 조건 적용) -->
    <select id="getMembersByCriteria" resultType="Member">
        SELECT member_login_id, member_name, member_phone, member_email, created_at
        FROM member
        <where>
            <if test="name != null and name != ''">
                AND member_name LIKE CONCAT('%', #{memberName}, '%')
            </if>
            <if test="phone != null and phone != ''">
                AND member_phone LIKE CONCAT('%', #{memberPhone}, '%')
            </if>
            <if test="email != null and email != ''">
                AND member_email LIKE CONCAT('%', #{memberEmail}, '%')
            </if>
        </where>
        ORDER BY created_at DESC
    </select>

    <!-- 고객 상세 조회 -->
    <select id="getMemberDetails" resultType="Member">
        SELECT member_id, name, phone, email, address, created_at
        FROM member
        WHERE member_id = #{memberId}
    </select>

    <!-- 로그인 id로 직원 id 조회 -->
    <select id="findStaffIdByStaffLoginId" resultType="long">
        SELECT staff_id
        FROM staff
        WHERE staff_login_id = #{staffLoginId}
    </select>


</mapper>